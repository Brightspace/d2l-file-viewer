<link rel="import" href="../app-localize-behavior/app-localize-behavior.html">

<script>
	'use strict';

	(function() {
		window.D2L = window.D2L || {};
		window.D2L.FileViewer = window.D2L.FileViewer || {};

		/*
		 * Behavior for elements that require localization, based on `app-localize-behavior`
		 * @polymerBehavior window.D2L.FileViewer.LocalizeBehavior
		 */
		window.D2L.FileViewer.LocalizeBehaviorImpl = {
			properties: {
				language: {
					type: String,
					computed: '_determineLanguage(locale, resources)'
				},
				locale: {
					type: String,
					value: function() {
						return document.documentElement.lang
							|| document.documentElement.getAttribute('data-lang-default')
							|| 'en-us';
					}
				},
				useKeyIfMissing: {
					type: Boolean,
					value: true
				},
				resources: {
					value: function() {
						return {
							'en': this.en,
							'ar': this.ar,
							'de': this.de,
							'es': this.es,
							'fr': this.fr,
							'ja': this.ja,
							'ko': this.ko,
							'nl': this.nl,
							'pt': this.pt,
							'sv': this.sv,
							'tr': this.tr,
							'zh': this.zh,
							'zh-tw': this.zhTw
						}
					}
				}
			},
			_determineLanguage: function(locale, resources) {
				locale = locale.toLowerCase();

				if(resources[locale]) {
					return locale;
				}

				var langAndRegion = locale.split('-');

				if(resources[langAndRegion[0]]) {
					return langAndRegion[0];
				}

				return 'en';
			}
		};

		// TODO: individual lang behaviors
		/* @polymerBehavior */
		window.D2L.FileViewer.LocalizeBehavior = [
			Polymer.AppLocalizeBehavior,
			window.D2L.FileViewer.LocalizeBehaviorImpl,
			window.D2L.FileViewer.LocalizeBehavior.LangEnBehavior
		];
	})();
</script>
