<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-icons/d2l-icon.html">
<link rel="import" href="../d2l-typography/d2l-typography-shared-styles.html">
<link rel="import" href="localize-behavior.html">

<script src="./util/namespace.js"></script>

<dom-module id="d2l-pdf-viewer-toolbar">
	<template strip-whitespace>
		<style>
			:host {
				cursor: default;
				width: 100%;
			}

			.outer-container {
				display: flex;
				justify-content: center;
			}

			#toolbarContainer {
				display: inline-flex;
				align-items: center;
				padding: 10px;
				position: relative;
				height: 29px;
				background: rgba(86, 90, 92, 0.8);
				border-radius: 8px;
				color: white;
				margin: 0 auto;
			}

			#toolbarContainer > * {
				flex: 0 0 auto;
			}

			.toolbarLabel {
				@apply --d2l-label-text;
				font-size: 0.8rem;
				min-width: 16px;
				padding: 3px 6px 3px 2px;
				margin: 4px 2px 4px 0;
				border: 1px solid transparent;
				border-radius: 2px;
				text-align: left;
				cursor: default;
				user-select: none;
			}

			:host-context([dir="rtl"]) .toolbarLabel {
				padding: 3px 2px 3px 6px;
				margin: 4px 0 4px 2px;
			}

			#numPages {

			}

			.toolbarButton {
				border: 0 none;
				background: none;
				width: 32px;
				height: 25px;
				margin: 2px 2px 4px 0;
				min-width: 16px;
				padding: 2px 6px 0;
				border-radius: 2px;
				/* Opera does not support user-select, use <... unselectable="on"> instead */
				cursor: default;
				transition-property: background-color, border-color, box-shadow;
				transition-duration: 150ms;
				transition-timing-function: ease;
			}

			.toolbarButton[disabled] {
				opacity: .5;
			}

			.toolbarButton:hover:not(:disabled),
			.toolbarButton:focus:not(:disabled) {
				background-color: hsla(0,0%,0%,.12);
				background-image: linear-gradient(hsla(0,0%,100%,.05), hsla(0,0%,100%,0));
				background-clip: padding-box;
				border: 1px solid hsla(0,0%,0%,.35);
				border-color: hsla(0,0%,0%,.32) hsla(0,0%,0%,.38) hsla(0,0%,0%,.42);
				box-shadow: 0 1px 0 hsla(0,0%,100%,.05) inset,
							0 0 1px hsla(0,0%,100%,.15) inset,
							0 1px 0 hsla(0,0%,100%,.05);
			}

			.toolbarButton:hover:active:not(:disabled),
			.overlayButton:hover:active:not(:disabled) {
				background-color: hsla(0,0%,0%,.2);
				background-image: linear-gradient(hsla(0,0%,100%,.05), hsla(0,0%,100%,0));
				border-color: hsla(0,0%,0%,.35) hsla(0,0%,0%,.4) hsla(0,0%,0%,.45);
				box-shadow: 0 1px 1px hsla(0,0%,0%,.1) inset,
							0 0 1px hsla(0,0%,0%,.2) inset,
							0 1px 0 hsla(0,0%,100%,.05);
				transition-property: background-color, border-color, box-shadow;
				transition-duration: 10ms;
				transition-timing-function: linear;
			}

			:host-context([dir="rtl"]) .toolbarButton {
				margin: 2px 0 4px 2px;
			}

			@media screen and (max-width: 767px) {
				.right-spacer {
					display: none;
				}
			}

			button {
				width: 30px;
				height: 30px;
				border: 0;
				background: none;
			}

			button:hover, button:focus, button:active {
				background-color: blue;
			}

			d2l-icon {
				color: white;
			}

			span {
				user-select: none;
			}
		</style>
		<div class="outer-container">
			<div id="toolbarContainer">
				<span id="pageNumber"
					class="pageNumber"
					aria-label$="[[localize('pageLabel')]]">
					[[localize('pageOfPages', 'pageNumber', pageNumber, 'pagesCount', pagesCount)]]
				</span>
				<button id="zoomOut"
					class="toolbarButton zoomOut"
					disabled$="[[_zoomOutButtonDisabled(pageScale, minPageScale)]]"
					on-tap="_onTapZoomOut"
					aria-label$="[[localize('zoomOutLabel')]]"
					title$="[[localize('zoomOutTitle')]]">
					<d2l-icon icon="d2l-tier1:zoom-out"></d2l-icon>
				</button>
				<button id="zoomIn"
					class="toolbarButton zoomIn"
					disabled$="[[_zoomInButtonDisabled(pageScale, maxPageScale)]]"
					on-tap="_onTapZoomIn"
					aria-label$="[[localize('zoomInLabel')]]"
					title$="[[localize('zoomInTitle')]]">
					<d2l-icon icon="d2l-tier1:zoom-in"></d2l-icon>
				</button>
				<button id="fullScreen"
					class="toolbarButton">
					<d2l-icon icon="d2l-tier1:fullscreen"></d2l-icon>
				</button>
			</div>
		</div>
	</template>
	<script>
		Polymer({
			is: 'd2l-pdf-viewer-toolbar',
			properties: {
				pageLabel: String,
				pageNumber: {
					type: Number,
					value: 0
				},
				pagesCount: {
					type: Number,
					value: 0
				},
				pageScale: {
					type: Number,
					value: 0
				},
				_minScale: {
					type: Number,
					value: 0
				},
				_maxScale: {
					type: Number,
					value: 0
				},
				_inputPageNumber: {
					type: Number,
					value: 0
				},
				minPageScale: {
					type: Number,
					value: 0
				},
				maxPageScale: {
					type: Number,
					value: 0
				}
			},

			behaviors: [
				window.D2L.PolymerBehaviors.FileViewer.LocalizeBehavior
			],

			// --element attributes--
			// compute zoom out button disabled
			_zoomOutButtonDisabled: function(pageScale, minPageScale) {
				return pageScale <= minPageScale || Math.abs(pageScale - minPageScale) < Number.EPSILON;
			},
			// compute zoom in button disabled
			_zoomInButtonDisabled: function(pageScale, maxPageScale) {
				return pageScale >= maxPageScale || Math.abs(pageScale - maxPageScale) < Number.EPSILON;
			},
			// --events--
			// click zoom in
			_onTapZoomIn: function() {
				this.dispatchEvent(
					new CustomEvent('d2l-pdf-viewer-toolbar-zoom-in')
				);
			},
			// click zoom out
			_onTapZoomOut: function() {
				this.dispatchEvent(
					new CustomEvent('d2l-pdf-viewer-toolbar-zoom-out')
				);
			}
		});
	</script>
</dom-module>
